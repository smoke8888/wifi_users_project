# wifi_users_project

В данном разделе представлены исходные коды подготовленные для защиты проектной работы по курсу "Дата инженер". 

**Задача проекта:** используя инструментарий DataLake и DataWarehouse реализовать систему аналитики данных о пользователях публичных wifi сетей. 
Репозиторий содержит следующие файлы:
1. **generate_wifi_users.py** - код, генерирующий данные о пользотвателях публичных wifi сетей в формате csv. Генератор создает 1000 строк данных, таких как:

   **phone_number** - телефонный номер пользователя публичного wifi

   **session_start** - таймшатмп старта пользовательской сессии

   **session_duration** - длительность пользовательской сессии, минут

   **traffic** - объем трафика потребленный пользователем за время сессии, МБ

   **company_id** - идентификатор организации (компании), к wifi-сети которой подключился пользователь

   **device** - тип операционной системы пользовательского устройства

   **ident_type** - тип идентификации пользователя (SMS, Вызов на 8-800 и Госуслуги)

2. **generate_rtk_users.py** - код, генерирующий справочную таблицу абонентов Оператора связи. Генератор создает 100 000 строк данных формата:

   **def_number** - номер абонента Оператора (DEF xyz abcd)

   **name** - ФИО абонента

   **age** - возраст абонента, лет

   **gender** - пол абонента (1 - муж, 0 - жен).
   
3. **csv_to_hdfs_rtk_users.py** - код, выполняющий сохранение таблицы rtk_users.csv в parquet файл hdfs файловой системы Hadoop
4. **csv_to_hdfs_company.py** - код, выполняющий сохранение таблицы company.csv в parquet файл hdfs файловой системы Hadoop
5. **csv_to_hdfs_wifi_users.py** - код, выполняющий сохранение таблицы wifi_users.csv в parquet файл hdfs файловой системы Hadoop методом **append**
6. **krasnickiy_wifi_kurs_DAG.py** - Apache Airflow DAG, выполняющий вызов скриптов **generate_wifi_users.py**, **csv_to_hdfs_wifi_users.py**, **csv_to_hdfs_rtk_users.py** и  **csv_to_hdfs_company.py** на удаленном сервере. А также выполняющий обращение к Greenplum для обновления материализованного представления, содержащего итоговый датасет 
7. **rtk_users.csv** - фрагмент справочной таблицы о пользователях Оперератора
8. **company.csv** - фрагмент справочной таблицы об организациях (компаниях), предоставляющих доступ к публичному wifi
9. **wifi_users.csv** - фрагмент рабочей таблицы о пользователях публичного wifi

	 
